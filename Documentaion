Market Data Collector - Full Process Documentation
Overview
# Market Data Collector - Full Process Documentation
## Overview
This document outlines the entire development process of the **Market Data Collector** bot, detailing the step-by-step changes, improvements, and troubleshooting performed to build an automated stock market data retrieval and analysis system.
---
## **1ï¸âƒ£ Initial Setup**
### Steps:
âœ… Installed Python and necessary dependencies.
âœ… Set up a virtual environment (`venv`).
âœ… Installed required packages (`yfinance`, `pandas`, `sqlite3`, `openpyxl`, `matplotlib`).
âœ… Created initial script `fetch_stock_data.py` using Yahoo Finance API.
### Issues Encountered:
âŒ Yahoo Finance API inconsistenciesâ€”data retrieval failures.
âœ” **Solution:** Switched to **Alpha Vantage API** for more reliability.
---
## **2ï¸âƒ£ Fetching Stock Data & Storing in SQLite**
### Changes Made:
âœ… Configured Alpha Vantage API in `fetch_stock_data.py`.
âœ… Read stock symbols from `stocks.txt`.
âœ… Stored fetched stock data in an **SQLite database (`stocks_info.db`)**.
âœ… Ensured **no duplicate entries** using SQL `PRIMARY KEY (Stock_Symbol, Date)`.
âœ… Limited fetching to the last **two days** to optimize API limits.
### Issues Encountered:
âŒ Alpha Vantage's **free tier limit (25 requests per day)**.
âœ” **Solution:** Limited fetch frequency to **once per day**.
---
## **3ï¸âƒ£ Exporting Data to Excel**
### Changes Made:
âœ… Created `export_to_excel.py` to output stock data into an **Excel file (`stock_report.xlsx`)**.
âœ… Stored each stock's data in **separate sheets** named after the stock symbol.
âœ… Added a **summary sheet (`DataOverview`)** displaying all stocks side by side.
âœ… Inserted a **blank column** between each stock in `DataOverview` for readability.
âœ… Applied **alternating row colors** (light blue) for better visualization.
### Issues Encountered:
âŒ `ValueError: cannot insert, already exists` when adding blank columns.
âœ” **Solution:** Fixed logic by ensuring **unique column names**.
---
## **4ï¸âƒ£ Trend Analysis & Visualization**
### Changes Made:
âœ… Created `analyze_stock_trends.py` for **moving averages & Bollinger Bands**.
âœ… Plotted each stockâ€™s trends using **Matplotlib**.
âœ… Saved all plots inside the **`analysis_plots/`** directory.
âœ… Ensured images **overwrite themselves** to prevent duplicates.
### Issues Encountered:
âŒ **Blank plots** due to incorrect DataFrame filtering.
âœ” **Solution:** Adjusted logic to **group stock data properly** before plotting.
---
## **5ï¸âƒ£ Automation & Task Scheduling**
### Changes Made:
âœ… Automated **fetch_stock_data.py** via **Windows Task Scheduler** (Runs daily at 10 PM CET).
âœ… Scheduled **export_to_excel.py** to run **after fetching**.
âœ… Ensured scripts run **even when PC is asleep**.
### Issues Encountered:
âŒ Task Scheduler **failed to start due to incorrect user permissions**.
âœ” **Solution:** Configured Task Scheduler to run scripts as **admin**.
---
## **6ï¸âƒ£ Configuration File (`config.json`)**
### Changes Made:
âœ… Created `config.json` to store:
- **Alpha Vantage API key**
- **Database file path**
- **Output Excel file path**
- **Backup folder path**
âœ… Updated all scripts to **read from config.json** instead of hardcoding values.
### Issues Encountered:
âŒ `KeyError: 'output_excel'` due to missing config entry.
âœ” **Solution:** Ensured `config.json` contains **all required keys**.
---
## **7ï¸âƒ£ Backup System**
### Changes Made:
âœ… Implemented **database backup system** (`backup.py`).
âœ… Automatically **copies `stocks_info.db`** to `backups/` before updates.
âœ… Appends **timestamp** to backup file names.
### Issues Encountered:
âŒ Backup system **failed due to locked database**.
âœ” **Solution:** Ensured SQLite connection **closes before backup starts**.
---
## **8ï¸âƒ£ Final GitHub Setup**
### Steps:
âœ… Created **README.md** with complete setup instructions.
âœ… Uploaded project to **GitHub**.
âœ… Organized project structure:
```
MarketDataCollector/
â”‚â”€â”€ fetch_stock_data.py # Fetches stock data
â”‚â”€â”€ export_to_excel.py # Exports stock data to Excel
â”‚â”€â”€ analyze_stock_trends.py # Generates stock analysis plots
â”‚â”€â”€ backup.py # Creates database backups
â”‚â”€â”€ config.json # Stores API key & settings
â”‚â”€â”€ stocks_info.db # SQLite database
â”‚â”€â”€ backups/ # Stores backups
â”‚â”€â”€ analysis_plots/ # Stores stock trend images
â”‚â”€â”€ requirements.txt # Python dependencies
â”‚â”€â”€ README.md # Project documentation
```
---
## **Next Steps**
âœ… **Market Data Collector bot is complete!** ğŸ‰
For future improvements, consider:
- Expanding analysis **beyond moving averages** (e.g., RSI, MACD).
- Implementing **cloud-based execution** to eliminate PC dependency.
- Adding **automated trading signals** based on historical patterns.
This concludes the full documentation of the **Market Data Collector** project.

1ï¸âƒ£ Initial Setup
Steps:
âœ… Installed Python and necessary dependencies.
 âœ… Set up a virtual environment (venv).
 âœ… Installed required packages (yfinance, pandas, sqlite3, openpyxl, matplotlib).
 âœ… Created initial script fetch_stock_data.py using Yahoo Finance API.
Issues Encountered:
âŒ Yahoo Finance API inconsistenciesâ€”data retrieval failures.
 âœ” Solution: Switched to Alpha Vantage API for more reliability.

2ï¸âƒ£ Fetching Stock Data & Storing in SQLite
Changes Made:
âœ… Configured Alpha Vantage API in fetch_stock_data.py.
 âœ… Read stock symbols from stocks.txt.
 âœ… Stored fetched stock data in an SQLite database (stocks_info.db).
 âœ… Ensured no duplicate entries using SQL PRIMARY KEY (Stock_Symbol, Date).
 âœ… Limited fetching to the last two days to optimize API limits.
Issues Encountered:
âŒ Alpha Vantage's free tier limit (25 requests per day).
 âœ” Solution: Limited fetch frequency to once per day.

3ï¸âƒ£ Exporting Data to Excel
Changes Made:
âœ… Created export_to_excel.py to output stock data into an Excel file (stock_report.xlsx).
 âœ… Stored each stock's data in separate sheets named after the stock symbol.
 âœ… Added a summary sheet (DataOverview) displaying all stocks side by side.
 âœ… Inserted a blank column between each stock in DataOverview for readability.
 âœ… Applied alternating row colors (light blue) for better visualization.
Issues Encountered:
âŒ ValueError: cannot insert, already exists when adding blank columns.
 âœ” Solution: Fixed logic by ensuring unique column names.

4ï¸âƒ£ Trend Analysis & Visualization
Changes Made:
âœ… Created analyze_stock_trends.py for moving averages & Bollinger Bands.
 âœ… Plotted each stockâ€™s trends using Matplotlib.
 âœ… Saved all plots inside the analysis_plots/ directory.
 âœ… Ensured images overwrite themselves to prevent duplicates.
Issues Encountered:
âŒ Blank plots due to incorrect DataFrame filtering.
 âœ” Solution: Adjusted logic to group stock data properly before plotting.

5ï¸âƒ£ Automation & Task Scheduling
Changes Made:
âœ… Automated fetch_stock_data.py via Windows Task Scheduler (Runs daily at 10 PM CET).
 âœ… Scheduled export_to_excel.py to run after fetching.
 âœ… Ensured scripts run even when PC is asleep.
Issues Encountered:
âŒ Task Scheduler failed to start due to incorrect user permissions.
 âœ” Solution: Configured Task Scheduler to run scripts as admin.

6ï¸âƒ£ Configuration File (config.json)
Changes Made:
âœ… Created config.json to store:
Alpha Vantage API key
Database file path
Output Excel file path
Backup folder path âœ… Updated all scripts to read from config.json instead of hardcoding values.
Issues Encountered:
âŒ KeyError: 'output_excel' due to missing config entry.
 âœ” Solution: Ensured config.json contains all required keys.

7ï¸âƒ£ Backup System
Changes Made:
âœ… Implemented database backup system (backup.py).
 âœ… Automatically **copies **stocks_info.db to backups/ before updates.
 âœ… Appends timestamp to backup file names.
Issues Encountered:
âŒ Backup system failed due to locked database.
 âœ” Solution: Ensured SQLite connection closes before backup starts.

8ï¸âƒ£ Final GitHub Setup
Steps:
âœ… Created README.md with complete setup instructions.
 âœ… Uploaded project to GitHub.
 âœ… Organized project structure:
MarketDataCollector/
â”‚â”€â”€ fetch_stock_data.py         # Fetches stock data
â”‚â”€â”€ export_to_excel.py          # Exports stock data to Excel
â”‚â”€â”€ analyze_stock_trends.py     # Generates stock analysis plots
â”‚â”€â”€ backup.py                   # Creates database backups
â”‚â”€â”€ config.json                 # Stores API key & settings
â”‚â”€â”€ stocks_info.db              # SQLite database
â”‚â”€â”€ backups/                    # Stores backups
â”‚â”€â”€ analysis_plots/             # Stores stock trend images
â”‚â”€â”€ requirements.txt            # Python dependencies
â”‚â”€â”€ README.md                   # Project documentation


Next Steps
âœ… Market Data Collector bot is complete! ğŸ‰
For future improvements, consider:
Expanding analysis beyond moving averages (e.g., RSI, MACD).
Implementing cloud-based execution to eliminate PC dependency.
Adding automated trading signals based on historical patterns.
This concludes the full documentation of the Market Data Collector project.
